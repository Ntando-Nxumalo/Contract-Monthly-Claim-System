@model Contract_Monthly_Claim_System.Models.Claim
@{
    ViewData["Title"] = "Claim Details";
}
<link rel="stylesheet" href="~/css/dashboard.css" />
<div class="container">
    <div class="header-nav">
        <h2>Claim Details</h2>
        <div class="nav-menu">
            <a href="@Url.Action("ViewClaims","Claims")">Back to Review</a>
            <span class="separator">|</span>
            <a href="/Claims/MyClaims">My Claims</a>
        </div>
    </div>

    <div class="pending-claims">
        <div class="section-header">
            <h2>Summary</h2>
        </div>
        <div class="claim-details" style="display:grid;grid-template-columns:1fr 1fr;gap:20px;">
            <div class="detail-group">
                <label>Lecturer</label>
                <span>@Model.LecturerName</span>
            </div>
            <div class="detail-group">
                <label>Date Submitted</label>
                <span>@Model.CreatedAt.ToLocalTime().ToString("MMM dd, yyyy HH:mm")</span>
            </div>
            <div class="detail-group">
                <label>Hours Worked</label>
                <span>@Model.HoursWorked</span>
            </div>
            <div class="detail-group">
                <label>Hourly Rate</label>
                <span>R @String.Format("{0:N2}", Model.HourlyRate)</span>
            </div>
            <div class="detail-group">
                <label>Total</label>
                <span>R @String.Format("{0:N2}", Model.Total)</span>
            </div>
            <div class="detail-group">
                <label>Status</label>
                <span class="status-badge @(Model.Status == "Pending" ? "status-pending" : Model.Status == "Approved" ? "status-approved" : Model.Status == "Rejected" ? "status-rejected" : "")">@Model.Status</span>
            </div>
            <div class="detail-group" style="grid-column:1/-1;">
                <label>Notes</label>
                <span>@Model.Notes</span>
            </div>
        </div>

        <div class="documents-list">
            <h3 style="margin: 20px 0 10px 0;">Documents</h3>
            @if (Model.Documents != null && Model.Documents.Any())
            {
                foreach (var d in Model.Documents)
                {
                    <div class="document-item">
                        <a href="@Url.Action("DownloadDocument","Claims", new { id = d.Id })" title="Download">
                            <i class="fas fa-file"></i> @d.FileName
                        </a>
                        <span>@d.UploadedAt.ToLocalTime().ToString("MMM dd, yyyy HH:mm")</span>
                    </div>
                }
            }
            else if (!string.IsNullOrEmpty(Model.DocumentPath))
            {
                <div class="document-item">
                    <a href="@Model.DocumentPath" target="_blank">Open Document</a>
                </div>
            }
            else
            {
                <div>No documents uploaded.</div>
            }
        </div>

        @if (User.IsInRole("Program Coordinator") || User.IsInRole("Academic Manager"))
        {
            <div class="modal-actions">
                <form asp-controller="Claims" asp-action="Approve" method="post" style="display:inline">
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="id" value="@Model.Id" />
                    <button type="submit" class="btn btn-success btn-sm">Approve</button>
                </form>
                <form asp-controller="Claims" asp-action="Reject" method="post" style="display:inline; margin-left:6px">
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="id" value="@Model.Id" />
                    <button type="submit" class="btn btn-danger btn-sm">Reject</button>
                </form>
            </div>
        }
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
